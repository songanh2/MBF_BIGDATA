{
	 "description":"ADME_INVOICE_EDR",
	 "sqlStatements": [
	  {
		"sql"      	:"
					SELECT 
						CAST(DATE_FORMAT(A.MONTH,'yyyyMM') AS INTEGER)  	AS MO_KEY  , 
						CAST(DATE_FORMAT(A.MONTH,'HH') AS INTEGER) 			AS HOUR_KEY  , 
						CAST(NULL AS STRING) 								AS UUID   , 
						CAST(A.MONTH AS TIMESTAMP)						 	AS INVC_DT   , 
						A.INVOICE_ID 										AS INVC_NBR_REF   , 
						CAST(NULL AS STRING) 								AS PREV_INVC_NBR_REF   , 
						CAST(NULL AS TIMESTAMP) 							AS INVC_DUE_DT   , 
						CAST(NULL AS TIMESTAMP) 							AS INVC_EXTENDED_DUE_DT   , 
						CAST(NULL AS bigint) 								AS BLLG_OPRTR_KEY   , 
						CAST(NULL AS STRING) 								AS BLLG_OPRTR_CD   , 
						CAST(NULL AS TIMESTAMP) 							AS BLLG_START_DT   , 
						CAST(NULL AS STRING) 								AS BILL_GRP_CD   , 
						CAST(DATE_FORMAT(A.STA_DATE,'yyyyMM') AS bigint) 	AS BILL_CYCLE_KEY   , 
						CAST(A.STA_DATE AS TIMESTAMP) 						AS BLLG_PRD_START_DT   , 
						CAST(A.END_DATE AS TIMESTAMP) 						AS BLLG_PRD_END_DT   , 
						A.STATUS 											AS BLLG_STAT_CD   , 
						CAST(NULL AS STRING) 								AS BLLG_STAT_RSN_CD   , 
						CAST(NULL AS STRING) 								AS FILE_NAME   , 
						CAST(NULL AS TIMESTAMP) 							AS FILE_DT   , 
						CAST(NULL AS STRING) 								AS FILE_PREFIX_CD   , 
						CAST(NULL AS TIMESTAMP) 							AS REC_PROCESS_DT   , 
						CAST(NULL AS STRING) 								AS SWITCH_CD   , 
						CAST(NULL AS DECIMAL(27,0)) 						AS ACCT_SRVC_INSTANCE_KEY   , 
						CAST(NULL AS STRING) 					 			AS SERVICE_NBR   , 
						CAST(NULL AS DECIMAL(27,0))							AS ACCT_KEY   , 
						CAST(NULL AS DECIMAL(27,0))							AS BILLABLE_ACCT_KEY   , 
						cast(B.CUST_KEY	as DECIMAL(27,0))					AS CUST_KEY   , 
						B.CUST_TYP_CD 										AS CUST_TYP_CD , 
						CAST(NULL AS STRING) 								AS NTWK_QOS_GRP_CD   , 
						CAST(NULL AS TIMESTAMP) 							AS ACCT_ACTIVATION_DT   , 
						CAST(NULL AS TIMESTAMP) 							AS ACCT_CBS_ACTIVATION_DT   , 
						CAST(NULL AS STRING) 								AS ACCT_LFCYCL_STAT_CD   , 
						CAST(NULL AS TIMESTAMP) 							AS SRVC_ACTIVATION_DT   , 
						CAST(NULL AS TIMESTAMP) 							AS SRVC_CBS_ACTIVATION_DT   , 
						CAST(NULL AS STRING)								AS SRVC_LFCYCL_STAT_CD   , 
						CAST(NULL AS INTEGER) 								AS PROD_LINE_KEY   , 
						CAST(NULL AS bigint) 								AS USAGE_PLAN_KEY   , 
						CAST(NULL AS STRING) 								AS USAGE_PLAN_CD   , 
						CAST(NULL AS STRING) 								AS USAGE_PLAN_TYP_CD   , 
						CAST(NULL AS TIMESTAMP) 							AS INVC_POST_DT   , 
						CAST(NULL AS TIMESTAMP) 							AS INVC_PRINTED_DT   , 
						CAST(NULL AS TIMESTAMP) 							AS INVC_EMAIL_DT   , 
						CAST(NULL AS STRING) 								AS INVC_EMAIL_STAT_CD   , 
						CAST(NULL AS TIMESTAMP) 							AS INVC_SENT_DT   , 
						CAST(NULL AS STRING) 								AS INVC_DLVRY_CHNL_TYP_CD   , 
						CAST(NULL AS STRING) 								AS INVC_DLVRY_IND   , 
						CAST(NULL AS STRING) 								AS INSTALLMENT_IND   , 
						CAST(NULL AS STRING) 								AS DISPUTE_IND   , 
						CAST(NULL AS STRING) 								AS INVC_SHIPPING_REF   , 
						'NORMAL'			 								AS INVC_TYP_CD   , 
						CAST(NULL AS STRING) 								AS INVC_STAT_CD   , 
						CAST(NULL AS STRING) 								AS AUTO_PYMT_IND   , 
						CAST(NULL AS STRING) 								AS DEFAULT_PYMT_MTHD_CD   , 
						CAST(NULL AS STRING) 								AS INVC_PYMT_STAT_CD   , 
						'VND' 												AS CRNCY_CD   , 
						CAST(NULL AS DECIMAL(27,8))							AS TOT_ACCT_OS_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS DEPOSIT_PYMT_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS ADVANCED_PYMT_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS PREV_INVC_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS PREV_INVC_OS_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS PREV_INVC_CARRIED_FWD_AMT   , 
						CAST(NULL AS DECIMAL(27,8))							AS PREV_INVC_PYMT_AMT   , 
						CAST(A.ORG_AMOUNT_VAT AS DECIMAL(27,8)) 			AS INVC_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS TAX_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS INV_PYMT_ALLOC_AMT   , 
						CAST(NULL AS STRING) 								AS PYMT_REF_NBR   , 
						CAST(A.LAST_PAY_DATE AS TIMESTAMP) 					AS PYMT_DT   , 
						CAST(A.PAYMENT_AMOUNT_VAT AS DECIMAL(27,8)) 		AS PYMT_AMT   , 
						CAST(A.REMAIN_AMOUNT_VAT AS DECIMAL(27,8)) 			AS INV_OS_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS INVC_DISPUTE_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS INVC_WRITEOFF_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS INVC_RECOVRD_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS CHRG_AMT   , 
						CAST(A.PAYMENT_AMOUNT_VAT AS DECIMAL(27,8)) 		AS RVN_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS LATE_FEE_CHRG_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS NRC_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS RC_RVN_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS UC_RVN_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS DEBIT_ADJ_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS CREDIT_ADJ_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS ROAM_COST_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS ROAM_RVN_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS INTCONN_COST_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS INTCONN_RVN_AMT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS INTERNAL_COST_AMT   , 
						CAST(NULL AS STRING) 								AS ADD_INFO   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS ADDR_LAT   , 
						CAST(NULL AS DECIMAL(27,8)) 						AS ADDR_LON   , 
						CAST(NULL AS BIGINT) 								AS CELL_KEY   , 
						CAST(NULL AS STRING) 								AS CELL_CD   , 
						CAST(NULL AS BIGINT) 								AS CELL_SITE_KEY   , 
						CAST(NULL AS STRING) 								AS CELL_SITE_CD   , 
						CAST(NULL AS bigint) 								AS NTWK_MGNT_CENTRE_KEY   , 
						CAST(NULL AS STRING)							 	AS NTWK_MGNT_CENTRE_CD   , 
						CAST(B.BSNS_RGN_KEY AS bigint) 						AS BSNS_RGN_KEY   , 
						B.BSNS_RGN_CD				 						AS BSNS_RGN_CD   , 
						CAST(B.BSNS_CLUSTER_KEY AS bigint) 					AS BSNS_CLUSTER_KEY   , 
						B.BSNS_CLUSTER_CD									AS BSNS_CLUSTER_CD   , 
						CAST(B.BSNS_MINICLUSTER_KEY AS bigint) 				AS BSNS_MINICLUSTER_KEY   , 
						B.BSNS_MINICLUSTER_CD 								AS BSNS_MINICLUSTER_CD   , 
						CAST(B.GEO_CNTRY_KEY AS bigint) 					AS GEO_CNTRY_KEY   , 
						B.GEO_CNTRY_CD										AS GEO_CNTRY_CD   , 
						CAST(B.GEO_STATE_KEY AS bigint) 					AS GEO_STATE_KEY   , 
						B.GEO_STATE_CD 										AS GEO_STATE_CD,
						CAST(B.GEO_DSTRCT_KEY AS bigint) 					AS GEO_DSTRCT_KEY   , 
						B.GEO_DSTRCT_CD										AS GEO_DSTRCT_CD   , 
						CAST(B.GEO_CITY_KEY AS bigint) 						AS GEO_CITY_KEY   , 
						B.GEO_CITY_CD										AS GEO_CITY_CD   , 
						CAST(B.ACQSTN_DT AS TIMESTAMP) 						AS ACQSTN_DT   , 
						CAST(B.ACQSTN_BSNS_OUTLET_KEY AS bigint) 			AS ACQSTN_BSNS_OUTLET_KEY   , 
						B.ACQSTN_BSNS_OUTLET_CD								AS ACQSTN_BSNS_OUTLET_CD   , 
						CAST(NULL AS DECIMAL(12,4)) 						AS LOYALTY_RANK_SCORE   , 
						CAST(NULL AS TIMESTAMP) 							AS LOYALTY_SCORE_DT   , 
						CAST(NULL AS DECIMAL(12,4)) 						AS CREDIT_SCORE   , 
						CAST(NULL AS STRING) 								AS CREDIT_CLS_CD   , 
						CAST(NULL AS STRING) 								AS CREDIT_SCORE_METHOD   , 
						CAST(NULL AS TIMESTAMP) 							AS CREDIT_SCORE_DT   , 
						CAST(NULL AS INTEGER) 								AS RISK_IND   , 
						CAST(NULL AS STRING) 								AS ACCT_SEGMENT_CD   , 
						CAST(NULL AS STRING) 								AS ACCT_SEGMENT_DT   , 
						CAST(NULL AS STRING) 								AS CMPGN_CD   , 
						24 													AS SRC_SYS_KEY   , 
						'BILLING_GOLD' 										AS SRC_SYS_CD   , 
						CURRENT_TIMESTAMP() 								AS LOAD_DT   , 
						'1' 												AS CURR_IND   , 
						1 													AS WRHS_ID  
					FROM MBF_DATALAKE.B4_INVOICE A
					LEFT JOIN MBF_BIGDATA.ADMR_CUSTOMER B ON  B.CUST_KEY = cast(concat('1',A.CUST_ID) as bigint) AND B.DAY_KEY = '$day_key'
					WHERE A.DAY_KEY = '$day_key'								
					 ",
		"tempTable"  : "ADME_INVOICE_EDR_TEMP",
		"countSourceRecord":"1"
	  }   	  
	]
}